---
title: "R Notebook"
output: html_notebook
encoding: UTF-8
---



Pregunta 2 (50 puntos)
1. Descargue el precio de las acciones de Microsoft (“MSFT”) y Apple (“AAPL”) desde Enero
del 2000 hasta Agosto del 2018 con periodicidad mensual.
```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=TRUE, results='hide'}
library(dplyr)
library(tidyr)
library(tidyquant)
```

```{r echo = FALSE}
MSFT <- tq_get(c("MSFT"),
get = "stock.prices",
from = "2000-01-01",
to = "2018-8-30",
periodicity = "monthly")

AAPL <- tq_get(c("AAPL"),
get = "stock.prices",
from = "2000-01-01",
to = "2018-8-30",
periodicity = "monthly")
```


2. Utilizando los datos de 2.1, construya una función que permita:

  a. Calcular los retornos.
  b. Graficar los retornos y retornos acumulados.
  c. Testear normalidad utilizando Jarque-Bera (JB)
  
```{r echo = FALSE}

 function_finance <- function(x, return, graph, norm) {
   if (return=="yes") {
x <- x %>% 
mutate(retorno = log(close/lag(close))) 
  } else if (return=="no") {
    x <- x %>% 
mutate(retorno = (close-lag(close))/lag(close)) 
  }
      else   {
  return("Para return valores validos son solo yes y no")
  }
   
  if (graph=="type 1") {
grafico <- ggplot(x, aes(date, retorno))+
  geom_line()  

  } else if (graph=="type 2")   {
    

first <- x$close %>% first()
   x <- x %>%  mutate(retorno=(close-first/first))
  
   grafico <- ggplot(x, aes(date, retorno))+
  geom_line()
  
  }
   else   {
  return("Para return valores validos son solo type 1 y type 2")
  }
   
     if (norm=="yes") {
jb <- summarise(test, skew=((sum((x$close - mean(x$close))^3)/nrow(x))
                       /((sd(x$close))^3)),
                  kurt=((sum((x$close - mean(x$close))^4)/nrow(x))
                       /((sd(x$close))^4)),
           JB= (nrow(x)*(((skew^2)/6)+(((kurt-3)^2)/24)))
           )
  print(jb$JB)



  } else if (norm=="no")  {
jb <- summarise(test, skew=((sum((x$close - mean(x$close))^3)/nrow(x))
                       /((sd(x$close))^3)),
                  kurt=((sum((x$close - mean(x$close))^4)/nrow(x))
                       /((sd(x$close))^4)),
           JB= (nrow(x)*(((skew^2)/6)+(((kurt-3)^2)/24)))) 
  }
   
else   {
  return("Para return valores validos son solo yes y no")
  }
return(grafico)
}
 
 function_finance(MSFT, "yes", "type 1", "yes")
```


```{r echo = FALSE}

```


Pregunta 3 (30 puntos)
a. Calcule E(beta1) y var(beta1) para muestras de tamaños 50, 100, 500, 1000. ¿Existe sesgo?, ¿Desaparece
el sesgo a medida que el tamaño de la muestra aumenta?
```{r echo = FALSE}

```

b. Grafique la distribución de ˆ 1 para tamaños de muestra n = 50, 100, 500, 1000
```{r echo = FALSE}

```

c. Si x2 ~ U[0, 1], ¿Cómo cambian los resultados que obtuviste en (a) y (b)?

```{r echo = FALSE}

```
